(function(f){f.fn.taMenu=function(x){var e=f.extend({oneMenu:".oneMenu",twoMenu:".twoMenu",chose:"chose",orientation:"vertical",delay:300},x),s=f.isFunction,m=e.chose,y="."+m;return this.each(function(){function A(){t=!0;var a=g.find(y),c=a.index();a.removeClass(m);B.eq(c).removeClass(m);s(e.closeCall)&&e.closeCall.call(q,p,g,d);u=v=null}function x(a,c){function b(){"vertical"===e.orientation?(l=d.offset().left,h=d.offset().top,f=l,n=h+d.outerHeight()):"horizontal"===e.orientation&&(l=d.offset().left,
h=d.offset().top+d.outerHeight(),f=l+d.outerWidth(),n=h)}function k(){a.addClass(m).siblings(y).removeClass(m);w.addClass(m).siblings(y).removeClass(m)}var E=a.index(),w=B.eq(E),l,h,f,n;t?C=setTimeout(function(){r&&s(e.openCall)&&e.openCall.call(q,p,g,d,a,w);k();t=!1},300):(b(),F(c,v,u,l,h,f,n)?D=setTimeout(function(){z||(s(e.setOffsetCall)&&(e.setOffsetCall.call(q,p,g,d,a,w),b()),k())},e.delay):(s(e.setOffsetCall)&&(e.setOffsetCall.call(q,p,g,d,a,w),b()),k()))}function G(a,c){var b=n,k,d=b.length;
n=[];if(0>=d)return!1;"vertical"===e.orientation?(k=a.offset().top+0.5*a.outerHeight(),b.sort(function(a,b){return a[1]-b[1]}),v=b[d-1][1]<=k?b[d-1][0]:b[0][1]>=k?b[0][0]:b[Math.ceil(0.5*d)][0],u=k):"horizontal"===e.orientation&&(k=a.offset().left+0.5*a.outerWidth(),b.sort(function(a,b){return a[0]-b[0]}),u=b[d-1][0]<=k?b[d-1][1]:b[0][0]>=k?b[0][1]:b[Math.ceil(0.5*d)][1],v=k)}function F(a,c,b,d,f,g,l){var h=a.pageX;a=a.pageY;if(null==c||null==b)return!1;if("vertical"===e.orientation){if(a<b)return c=
(f-b)/(d-c)*(h-c)+b,a>=c?!0:!1;if(a>b)return c=(b-l)/(c-g)*(h-c)+b,a<=c?!0:!1}else if("horizontal"===e.orientation){if(h<c)return c=(f-b)/(d-c)*(h-c)+b,a<=c?!0:!1;if(h>c)return c=(b-l)/(c-g)*(h-c)+b,a<=c?!0:!1}}var q=this,p=f(q),g=p.find(e.oneMenu),d=p.find(e.twoMenu),H=g.find(".list"),B=d.find(".list"),v=null,u=null,D,C,t=!0,r=!0,z=!1,n=[];g.bind({mouseleave:function(){r=!0},mousemove:function(){t||(r=!1);return!1}});H.not(g.find(".allgoods")[0]).bind({mouseenter:function(a){x(f(this),a)},mousemove:function(a){n.push([a.pageX,
a.pageY])},mouseleave:function(a){clearTimeout(D);clearTimeout(C);G(f(this),a)}});g.find(".allgoods").bind({mouseenter:function(){return!1},mousemove:function(){return!1}});d.bind({mouseenter:function(){z=!0;r=!1},mouseleave:function(){z=!1;r=!0},mousemove:function(){return!1}});f(document).bind({mousemove:function(){A()}});f(".goodsClassBox .goodsClass").bind({mouseenter:function(){A()}})})}})(jQuery);
